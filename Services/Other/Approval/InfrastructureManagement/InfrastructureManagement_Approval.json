{
    "service": {
        "version": "1.0.0.0",
        "specVersion": "v3",
        "catalog_metadata": {
            "name": "Infrastructure Management Approval",
            "description": "Get approval from Infrastructure Management before provisioning",
            "image": "serviceicon_1.svg",
            "category": "Approval",
            "bullets": [
                {
                    "title": "Github link",
                    "description": "https://github.com/IBM-CAMHub-Open/servicelibrary/tree/5.3.0/Services/Other/Approval/InfrastructureManagement"
                }
            ],
            "providerDisplayName": "IBM",
            "longDescription": "Get approval from Infrastructure Management before provisioning",
            "documentationUrl": "",
            "supportUrl": "",
            "bindable": false,
            "updatable": "",
            "systemTags": true
        },
        "tags": [
            {
                "name": "environment",
                "label": "environment",
                "type": "string",
                "immutable": false,
                "hidden": false,
                "required": true,
                "secured": false,
                "description": "Unique identifer added to the provisioned VMs.",
                "isSystemTag": true,
                "customtype": "string",
                "permission": "Read-Write",
                "options": [
                    {
                        "label": "Development",
                        "value": "dev",
                        "default": true
                    },
                    {
                        "label": "Quality Assurance",
                        "value": "qa",
                        "default": false
                    },
                    {
                        "label": "Production",
                        "value": "prod",
                        "default": false
                    },
                    {
                        "label": "Test",
                        "value": "test",
                        "default": false
                    }
                ]
            },
            {
                "name": "Name",
                "label": "Name",
                "type": "string",
                "immutable": true,
                "hidden": false,
                "required": false,
                "secured": false,
                "description": "Name provided for the service instance by the end user at time of request",
                "isSystemTag": true,
                "customtype": "string",
                "permission": "Read-Only",
                "default": "${svc_instance.name}"
            },
            {
                "name": "request_group",
                "label": "request_group",
                "type": "string",
                "immutable": true,
                "hidden": false,
                "required": false,
                "secured": false,
                "description": "The current context group id of the current user that requested the provisioning of the template. This is important because a user may be part of more than one group and this identifies the context of which group the user made the request.",
                "isSystemTag": true,
                "customtype": "string",
                "permission": "Read-Only",
                "default": "${svc_instance.group}"
            },
            {
                "name": "request_user",
                "label": "request_user",
                "type": "string",
                "immutable": true,
                "hidden": false,
                "required": false,
                "secured": false,
                "description": "The user id of the current user that requested the provisioning of the template.",
                "isSystemTag": true,
                "customtype": "string",
                "permission": "Read-Only",
                "default": "${svc_instance.owner}"
            },
            {
                "name": "service_name",
                "label": "service_name",
                "type": "string",
                "immutable": true,
                "hidden": false,
                "required": false,
                "secured": false,
                "description": "Name provided for the service instance by the end user at time of request",
                "isSystemTag": true,
                "customtype": "string",
                "permission": "Read-Only",
                "default": "${svc_instance.name}"
            },
            {
                "name": "service_identifier",
                "label": "service_identifier",
                "type": "string",
                "immutable": true,
                "hidden": false,
                "required": false,
                "secured": false,
                "description": "Unique identifer generated by ICAM which is mapped to the service instance of the template provisioned.",
                "isSystemTag": true,
                "customtype": "string",
                "permission": "Read-Only",
                "default": "${svc_instance.service_instance_id}"
            }
        ],
        "upgrade_from": [],
        "downgrade_to": [],
        "actions": [
            {
                "type": "provision",
                "name": "Provision",
                "description": "Default action for deployment of service",
                "input_parameters": [
                    {
                        "name": "admin_email",
                        "label": "Admin Email",
                        "customtype": "string",
                        "type": "string",
                        "immutable": false,
                        "hidden": false,
                        "required": true,
                        "secured": false,
                        "isDynamic": false,
                        "editable": true
                    },
                    {
                        "name": "im_auth",
                        "label": "Infrastructure Management Authentication Details",
                        "customtype": "sharedparameter",
                        "type": "sharedparameter",
                        "immutable": false,
                        "hidden": false,
                        "required": true,
                        "secured": false,
                        "isDynamic": false,
                        "editable": true,
                        "default": "",
                        "datatype": "im_auth",
                        "passbyname": false,
                        "dynamicDetails": {}
                    },
                    {
                        "name": "curl_option",
                        "label": "CURL Option",
                        "customtype": "string",
                        "type": "string",
                        "immutable": false,
                        "hidden": false,
                        "required": false,
                        "secured": false,
                        "description": "Options for curl command used to retrieve status from Infrastructure Management e.g. --insecure",
                        "view": "create new",
                        "editable": true,
                        "passbyname": false,
                        "dynamicDetails": {},
                        "isDynamic": false
                    },
                    {
                        "name": "wait_time",
                        "label": "Wait Time (In Seconds)",
                        "customtype": "string",
                        "type": "string",
                        "immutable": false,
                        "hidden": false,
                        "required": true,
                        "secured": false,
                        "description": "Wait time in seconds i.e. time after which poll should again happen to retrieve the approval status",
                        "view": "create new",
                        "editable": true,
                        "default": "5"
                    },
                    {
                        "name": "url",
                        "label": "URL",
                        "customtype": "string",
                        "type": "string",
                        "immutable": false,
                        "hidden": false,
                        "required": true,
                        "secured": false,
                        "isDynamic": false,
                        "editable": true,
                        "description": "URL to submit approval request",
                        "passbyname": false,
                        "dynamicDetails": {}
                    },
                    {
                        "name": "payload",
                        "label": "Payload",
                        "customtype": "string",
                        "type": "string",
                        "immutable": false,
                        "hidden": false,
                        "required": true,
                        "secured": false,
                        "description": "Payload to submit approval request",
                        "isDynamic": false,
                        "editable": true,
                        "passbyname": false,
                        "dynamicDetails": {}
                    }
                ],
                "flow": {
                    "conditions": [
                        {
                            "decision": {
                                "title": "decision_aede04",
                                "options": [
                                    {
                                        "case": "approved",
                                        "sequence": {
                                            "0": "emailnot387e78ed"
                                        }
                                    },
                                    {
                                        "case": "denied",
                                        "sequence": {
                                            "0": "emailnot432fc669"
                                        }
                                    }
                                ],
                                "id": "decision54b364f4",
                                "editable": true,
                                "isErrorFlow": false,
                                "mapped_parameter": "${templates.pollclouc5a483f5.output.approval_status}"
                            }
                        }
                    ],
                    "templates": [
                        {
                            "Poll Infrastructure Management for Approval": {
                                "title": "Poll Infrastructure Management for Approval_1d503c",
                                "template_name": "Poll Infrastructure Management for Approval",
                                "version": "2.4",
                                "id": "pollclouc5a483f5",
                                "template_type": "Terraform",
                                "template_content_type": "Other",
                                "template_provider": "Other",
                                "instance_name": "",
                                "template_data_objects": {
                                    "im_auth": "${input_parameters.im_auth}"
                                },
                                "template_params": {
                                    "url": "${resthooks.resthook060a97c8.body.results[0].href}",
                                    "username": "${im_auth.username}",
                                    "password": "${im_auth.password}",
                                    "token": "${im_auth.token}",
                                    "curl_option": "${input_parameters.curl_option}",
                                    "wait_time": "${input_parameters.wait_time}"
                                },
                                "outputs": [
                                    "approval_status"
                                ],
                                "editable": true,
                                "provider_engine_version": "0.12.31",
                                "use_compatible_version": true,
                                "cloud_connection_names": [
                                {
                                    "provider": "Other",
                                    "connection_name": "Other"
                                }
                                ],
                                "isErrorFlow": false,
                                "cloud_connection_name": "Other"
                            }
                        }
                    ],
                    "resthooks": [
                        {
                            "resthook": {
                                "title": "resthook_2853fa",
                                "id": "resthook060a97c8",
                                "headers": {
                                    "accept": "application/json",
                                    "Content-Type": "application/json"
                                },
                                "editable": true,
                                "url": "${input_parameters.url}",
                                "method": "POST",
                                "isErrorFlow": false,
                                "payload": "${input_parameters.payload}"
                            }
                        }
                    ],
                    "notifications": [
                        {
                            "emailnotification": {
                                "title": "emailnotification_120f1a",
                                "type": "email",
                                "receiverList": "${input_parameters.admin_email}",
                                "id": "emailnot387e78ed",
                                "sender": "CAMadmin",
                                "copyToList": "",
                                "subject": "Approval Status",
                                "body": "Approval Status: \n\n${templates.pollclouc5a483f5.output.approval_status}",
                                "editable": true
                            }
                        },
                        {
                            "emailnotification": {
                                "title": "emailnotification_87bb9c",
                                "type": "email",
                                "receiverList": "${input_parameters.admin_email}",
                                "id": "emailnot432fc669",
                                "sender": "CAMadmin",
                                "copyToList": "",
                                "subject": "Approval Status",
                                "body": "Approval Status: ${templates.pollclouc5a483f5.output.approval_status}",
                                "editable": true
                            }
                        }
                    ],
                    "sequence": {
                        "0": "resthook060a97c8",
                        "1": "pollclouc5a483f5",
                        "2": "decision54b364f4"
                    },
                    "error_sequence": {}
                },
                "output_parameters": []
            }
        ],
        "plans": [
            {
                "name": "Standard",
                "description": "To deploy a Standard plan",
                "actions": [],
                "plan_parameters": []
            }
        ]
    }
}