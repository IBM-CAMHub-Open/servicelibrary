{
  "service": {
    "specVersion": "v3",
    "version": "2.0.0.0",
    "catalog_metadata": {
      "name": "Red Hat OpenShift Kubernetes Service on IBM Cloud with RHACM import",
      "description": "Deploys and imports Red Hat OpenShift Kubernetes Service cluster (ROKS) on IBM Cloud into an RHACM enabled IBM Cloud Pak For Multicloud Management.",
      "image": "serviceicon_1.svg",
      "category": "Cluster Lifecycle Services",
      "bullets": [
        {
          "title": "Cloud Provider",
          "description": "IBM Cloud"
        },
        {
          "title": "IBM Cloud Service",
          "description": "RedHat OpenShift Service on IBM Cloud"
        },
        {
          "title": "IBM Cloud Pak For Multicloud Management",
          "description": "IBM Cloud Pak For Multicloud Management"
        }
      ],
      "providerDisplayName": "IBM",
      "longDescription": "Deploys a Red Hat OpenShift Kubernetes Service cluster (ROKS) on IBM Cloud and imports the cluster into an Red Hat Advanced Cluster Management enabled IBM Cloud Pak For Multicloud Management hub-cluster.",
      "documentationUrl": "https://www.ibm.com/support/knowledgecenter/SSFC4F/product_welcome_cloud_pak.html",
      "supportUrl": "https://www.ibm.com/support/knowledgecenter/SSFC4F/product_welcome_cloud_pak.html",
      "bindable": false,
      "updatable": "",
      "systemTags": true,
      "author": "admin"
    },
    "tags": [
      {
        "name": "environment",
        "label": "Environment",
        "type": "string",
        "immutable": false,
        "hidden": false,
        "required": true,
        "secured": false,
        "description": "Unique identifer added to the provisioned VMs.",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Write",
        "options": [
          {
            "label": "Development",
            "value": "dev",
            "default": true
          },
          {
            "label": "Quality Assurance",
            "value": "qa",
            "default": false
          },
          {
            "label": "Production",
            "value": "prod",
            "default": false
          },
          {
            "label": "Test",
            "value": "test",
            "default": false
          }
        ]
      }, 
      {
        "name": "Name",
        "label": "Name",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Name provided for the service instance by the end user at time of request",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.name}"
      },         
      {
        "name": "request_group",
        "label": "request_group",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The current context group id of the current user that requested the provisioning of the template. This is important because a user may be part of more than one group and this identifies the context of which group the user made the request.",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.group}"
      },
      {
        "name": "request_user",
        "label": "request_user",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "The user id of the current user that requested the provisioning of the template.",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.owner}"
      },
      {
        "name": "service_name",
        "label": "service_name",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Name provided for the service instance by the end user at time of request",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.name}"
      },
      {
        "name": "service_identifier",
        "label": "service_identifier",
        "type": "string",
        "immutable": true,
        "hidden": false,
        "required": false,
        "secured": false,
        "description": "Unique identifer generated by ICAM which is mapped to the service instance of the template provisioned.",
        "isSystemTag": true,
        "customtype": "string",
        "permission": "Read-Only",
        "default": "${svc_instance.service_instance_id}"
      }
    ],
    "actions": [
      {
        "type": "provision",
        "name": "Provision",
        "description": "Default action for deployment of service",
        "input_parameters": [
          {
            "name": "cloud_connection",
            "label": "IBM Cloud Connection Name",
            "customtype": "connection",
            "type": "connection",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Name of the IBM cloud connection used to deploy the ROKS cluster",
            "provider": "IBM",
            "default": ""
          },
          {
            "name": "oc_login_info",
            "label": "OpenShift Container Platform Login Information",
            "customtype": "sharedparameter",
            "type": "sharedparameter",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Connection details for an OpenShift Container Platform on which IBM CP4MCM is installed.",
            "default": "",
            "datatype": "oc_login_info"
          },
          {
            "name": "cluster_name",
            "label": "Cluster name",
            "customtype": "string",
            "type": "string",
		    "regex": "(?:[a-z](?:[-a-z0-9]{0,30}[a-z0-9])?)",
            "regexdesc": "Cluster name can have lower case alphabets, numbers and dash. Must start with lower case alphabet and end with alpha-numeric character. Maximum length is 32 characters.",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Name of the ROKS cluster to be deployed"
          },
          {
            "name": "region",
            "label": "Region",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "options": [
                {
                    "value": "us-south",
                    "label": "US South",
                    "default": "true"
                },
                {
                    "value": "us-east",
                    "label": "US East"
                },
                {
                    "value": "au-syd",
                    "label": "Sydney"
                },
                {
                    "value": "eu-de",
                    "label": "Germany"
                },
                {
                    "value": "eu-gb",
                    "label": "United Kingdom"
                }
            ],
            "description": "IBM Cloud region"
          },
          {
            "name": "resource_group_name",
            "label": "IBM Cloud Resource Group Name",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Name of the IBM Cloud resource group. You must have access to at least one resource group in IBM Cloud."
          },        
          {
            "name": "private_vlan_id",
            "label": "Private VLAN",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Virtual network that allows private communication between worker nodes in this cluster. Can be retrieved by running bx cs vlans <location>."
          },
          {
            "name": "public_vlan_id",
            "label": "Public VLAN",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Virtual network that allows secured communication between the worker nodes and the IBM-managed master node. Can be retrieved by running bx cs vlans <location>."
          },
          {
            "name": "subnet_id",
            "label": "Subnet ID",
            "customtype": "list",
            "type": "list",
            "immutable": false,
            "hidden": false,
            "required": false,
            "secured": false,
            "description": "The portable subnet to use for cluster. A list of available subnets can be retrieved by running bx cs subnets."
          },
          {
            "name": "num_workers",
            "label": "Number of workers",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "options": [
                {
                    "value": "2",
                    "label": "2",
                    "default": "true"
                },
                {
                    "value": "3",
                    "label": "3"
                },
                {
                    "value": "4",
                    "label": "4"
                },
                {
                    "value": "5",
                    "label": "5"
                },
                {
                    "value": "6",
                    "label": "6"
                },
                {
                    "value": "7",
                    "label": "7"
                },
                {
                    "value": "8",
                    "label": "8"
                },
                {
                    "value": "9",
                    "label": "9"
                },
                {
                    "value": "10",
                    "label": "10"
                }
            ],
            "description": "Number of workers to be deployed in the cluster."
          },
          {
            "name": "datacenter",
            "label": "Datacenter",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "options": [
                {
                  "value": "ams01",
                  "label": "Amsterdam 01, The Netherlands"
                },
                {
                  "value": "ams03",
                  "label": "Amsterdam 03, The Netherlands"
                },
                {
                  "value": "che01",
                  "label": "Chennai, India"
                },
                {
                  "value": "dal01",
                  "label": "Dallas 01, USA"
                },
                {
                  "value": "dal02",
                  "label": "Dallas 02, USA"
                },
                {
                  "value": "dal05",
                  "label": "Dallas 05, USA"
                },
                {
                  "value": "dal06",
                  "label": "Dallas 06, USA"
                },
                {
                  "value": "dal07",
                  "label": "Dallas 07, USA"
                },
                {
                  "value": "dal09",
                  "label": "Dallas 09, USA"
                },
                {
                  "value": "dal10",
                  "label": "Dallas 10, USA"
                },
                {
                  "value": "dal12",
                  "label": "Dallas 12, USA"
                },
                {
                  "value": "dal13",
                  "label": "Dallas 13, USA",
                  "default": "true"
                },
                {
                  "value": "fra02",
                  "label": "Frankfurt, Germany"
                },
                {
                  "value": "hkg02",
                  "label": "Hong Kong, China"
                },
                {
                  "value": "hou02",
                  "label": "Houston, USA"
                },
                {
                  "value": "lon02",
                  "label": "London, England"
                },
                {
                  "value": "mel01",
                  "label": "Melbourne, Australia"
                },
                {
                  "value": "mil01",
                  "label": "Milan, Italy"
                },
                {
                  "value": "mon01",
                  "label": "Montreal, Canada"
                },
                {
                  "value": "osl01",
                  "label": "Oslo, Norway"
                },
                {
                  "value": "par01",
                  "label": "Paris, France"
                },
                {
                  "value": "mex01",
                  "label": "Quer\u00e9taro, Mexico"
                },
                {
                  "value": "sjc01",
                  "label": "San Jose 01, USA"
                },
                {
                  "value": "sjc03",
                  "label": "San Jose 03, USA"
                },
                {
                  "value": "sao01",
                  "label": "Sao Paulo, Brazil"
                },
                {
                  "value": "sea01",
                  "label": "Seattle, USA"
                },
                {
                  "value": "seo01",
                  "label": "Seoul 01, Korea"
                },
                {
                  "value": "sng01",
                  "label": "Singapore, Singapore"
                },
                {
                  "value": "syd01",
                  "label": "Sydney, Australia"
                },
                {
                  "value": "tok02",
                  "label": "Tokyo, Japan"
                },
                {
                  "value": "tor01",
                  "label": "Toronto, Canada"
                },
                {
                  "value": "wdc01",
                  "label": "Washington, D.C. 01, USA"
                },
                {
                  "value": "wdc04",
                  "label": "Washington, D.C. 04, USA"
                }
            ],
            "description": "IBM Cloud datacenter to create the cluster in."
          },
          {
            "name": "machine_type",
            "label": "Machine Type",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "default": "b3c.4x16",
            "description": "Machine type. Use ibmcloud ks flavors --zone <zone-name> to get the list of available machine flavors."
          },
          {
            "name": "isolation",
            "label": "Hardware Isolation",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "options": [
                {
                    "value": "shared",
                    "label": "Virtual Shared",
                    "default": "true"
                },
                {
                    "value": "dedicated",
                    "label": "Virtual Dedicated"
                },
                {
                    "value": "baremetal",
                    "label": "Bare Metal"
                }
            ],
            "description": "Hardware Isolation."
          },
          {
            "name": "roks_version",
            "label": "ROKS OCP version",
            "customtype": "string",
            "type": "string",
            "default": "4.3_openshift",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "ROKS OCP version for the cluster"
          },
          {
            "name": "kube_ctl_version",
            "label": "The kubectl version to run import commands. (Explicit version is recommended. Do not leave it as latest. Version format must be vM.m.p eg. v1.23.6) ",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "The kubectl version to use in import client. For compatibility reasons, this version must match the version in the kubernetes service. The latest client version may not be compatible with the latest kubernetes version used in the server. It is recommended that you set an explicit version. Version format must be vM.m.p eg. v1.23.6",
            "default": "latest"
          }
        ],
        "flow": {
          "conditions": [],
          "templates": [
            {
              "Red Hat OpenShift Single Zone Cluster on IBM Cloud": {
                "title": "Red Hat OpenShift Single Zone Cluster on IBM Cloud",
                "template_name": "Red Hat OpenShift Single Zone Cluster on IBM Cloud for Terraform 1.x.x",
                "version": "2.0",
                "id": "ibmcloud773459b0",
                "template_type": "Terraform",
                "template_content_type": "IBM",
                "template_provider": "IBM",
                "instance_name": "",
                "cloud_connection_name": "${input_parameters.cloud_connection}",
                "template_data_objects": {},
                "template_params": {
                  "region": "${input_parameters.region}",
                  "cluster_name": "${input_parameters.cluster_name}",
                  "resource_group_name": "${input_parameters.resource_group_name}",
                  "private_vlan_id": "${input_parameters.private_vlan_id}",
                  "public_vlan_id": "${input_parameters.public_vlan_id}",
                  "subnet_id": "${input_parameters.subnet_id}",
                  "num_workers": "${input_parameters.num_workers}",
                  "datacenter": "${input_parameters.datacenter}",
                  "machine_type": "${input_parameters.machine_type}",
                  "isolation": "${input_parameters.isolation}",
                  "roks_version": "${input_parameters.roks_version}"
                },
                "outputs": [
                  "cluster_name",
                  "cluster_config"
                ],
                "warning": false,
                "error": false,
                "provider_engine_version": "1.1.3"
              }
            },
            {
              "Import RedHat OpenShift Kubernetes Service on IBM Cloud into RHACM enabled IBM CP4MCM": {
                "title": "Import RedHat OpenShift Kubernetes Service on IBM Cloud into RHACM enabled IBM CP4MCM",
                "template_name": "Import RedHat OpenShift Kubernetes Service on IBM Cloud into RHACM enabled IBM CP4MCM for Terraform 1.x.x",
                "version": "5.2.0",
                "id": "importibe9990ade",
                "template_type": "Terraform",
                "template_content_type": "Other",
                "template_provider": "Other",
                "instance_name": "",
                "template_data_objects": {
                  "bastionhost": "DefaultNoBastionHostRequired",
                  "kubeconfig": "${input_parameters.cluster_name}",
                  "oc_login_info": "${input_parameters.oc_login_info}"
                },
                "template_params": {
                  "ocp_api_endpoint": "${oc_login_info.ocp_api_endpoint}",
                  "ocp_user": "${oc_login_info.ocp_user}",
                  "ocp_password": "${oc_login_info.ocp_password}",
                  "ocp_token": "${oc_login_info.ocp_token}",                  
                  "ocp_ca_cert": "${oc_login_info.ocp_ca_cert}",      
                  "cluster_name": "${kubeconfig.cluster_name}",
                  "cluster_config": "${kubeconfig.cluster_config}",
                  "kube_ctl_version": "${input_parameters.kube_ctl_version}"
                },
                "cloud_connection_names": [
                  {
                    "connection_name": "Other",
                    "provider": "Other"
                  }
                ],                
                "outputs": [],
                "error": false,
                "immutable": false,
                "provider_engine_version": "1.1.3"
              }
            }
          ],
          "resthooks": [],
          "notifications": [],
          "sequence": {
            "0": "ibmcloud773459b0",
            "1": "importibe9990ade"
          },
          "error_sequence": {}
        },
        "output_parameters": []
      }
    ],
    "plans": [
      {
        "name": "Standard",
        "description": "To deploy a Standard plan",
        "actions": [],
        "plan_parameters": [],
        "expanded": false
      }
    ]
  }
}