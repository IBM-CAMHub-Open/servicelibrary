{
    "service": {
      "specVersion": "v3",
	    "version": "3.11.0.0",      
      "catalog_metadata": {
        "name": "ICP on OCP on VMware",
        "description": "Deploy ICP 3.2.1 with OCP 3.11 cluster on VMware, and import the cluster to the IBM MCM 3.2.1 controller using IBM MCM 3.2.1 Klusterlet.",
        "image": "serviceicon_1.svg",
        "category": "Application Services",
        "bullets": [],
        "providerDisplayName": "IBM",
        "longDescription": "",
        "documentationUrl": "",
        "supportUrl": "",
        "bindable": false,
        "updatable": "",
        "systemTags": true
      },
      "tags": [
        {
          "name": "request_group",
          "label": "request_group",
          "type": "string",
          "immutable": true,
          "hidden": false,
          "required": false,
          "secured": false,
          "description": "The current context group id of the current user that requested the provisioning of the template. This is important because a user may be part of more than one group and this identifies the context of which group the user made the request.",
          "isSystemTag": true,
          "default": "${svc_instance.group}",
          "customtype": "string",
          "permission": "Read-Only"
        },
        {
          "name": "request_user",
          "label": "request_user",
          "type": "string",
          "immutable": true,
          "hidden": false,
          "required": false,
          "secured": false,
          "description": "The user id of the current user that requested the provisioning of the template.",
          "isSystemTag": true,
          "default": "${svc_instance.owner}",
          "customtype": "string",
          "permission": "Read-Only"
        },
        {
          "name": "service_name",
          "label": "service_name",
          "type": "string",
          "immutable": true,
          "hidden": false,
          "required": false,
          "secured": false,
          "description": "Name provided for the service instance by the end user at time of request",
          "isSystemTag": true,
          "default": "${svc_instance.name}",
          "customtype": "string",
          "permission": "Read-Only"
        },
        {
          "name": "service_identifier",
          "label": "service_identifier",
          "type": "string",
          "immutable": true,
          "hidden": false,
          "required": false,
          "secured": false,
          "description": "Unique identifer generated by ICAM which is mapped to the service instance of the template provisioned.",
          "isSystemTag": true,
          "default": "${svc_instance.service_instance_id}",
          "customtype": "string",
          "permission": "Read-Only"
        }
      ],
      "actions": [
        {
          "type": "provision",
          "name": "Provision",
          "description": "Default action for deployment of service",
          "input_parameters": [
          {
            "name": "cloud_connection",
            "label": "VMware Cloud Connection Name",
            "customtype": "connection",
            "type": "connection",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Name of the VMware cloud connection used to deploy the OpenShift Container Platform",
            "provider": "VMware vSphere",
            "default": ""
          },
          {
            "name": "openshift_admin_username",
            "label": "OpenShift Admin User Name",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Name of the cluster admin user that will be created on OpenShift",
            "default": "admin"
          },
          {
            "name": "openshift_admin_password",
            "label": "OpenShift Admin Password",
            "customtype": "password",
            "type": "password",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": true,
            "description": "Password for the OpenShift cluster admin user that will be created",
            "default": ""
          },
          {
            "name": "redhat_subscription",
            "label": "RedHat Subscription Data Object",
            "customtype": "sharedparameter",
            "type": "sharedparameter",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "RedHat Subscription used on the cluster nodes.",
            "default": "",
            "datatype": "redhat_subscription"
          },
          {
            "name": "vsphere_managed_inventory_definition",
            "label": "vSphere Managed Inventory Definition Data Object",
            "customtype": "sharedparameter",
            "type": "sharedparameter",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "vSphere Managed Inventory Definition",
            "default": "",
            "datatype": "vsphere_managed_inventory_definition"
          },
          {
            "name": "openshift_master_node_on_vmware",
            "label": "OpenShift Container Platform Master Node on VMware Data Object",
            "customtype": "sharedparameter",
            "type": "sharedparameter",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "OpenShift Container Platform Master Node on VMware Data Object",
            "default": "",
            "datatype": "openshift_master_node_on_vmware"
          },
          {
            "name": "openshift_lb_node_on_vmware",
            "label": "OpenShift Container Platform LB Node on VMware Data Object",
            "customtype": "sharedparameter",
            "type": "sharedparameter",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "OpenShift Container Platform LB Node on VMware",
            "default": "",
            "datatype": "openshift_lb_node_on_vmware"
          },
          {
            "name": "openshift_infra_node_on_vmware",
            "label": "OpenShift Container Platform Infrastructure Node on VMware Data Object",
            "customtype": "sharedparameter",
            "type": "sharedparameter",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "OpenShift Container Platform Infrastructure Node on VMware Data Object",
            "default": "",
            "datatype": "openshift_infra_node_on_vmware"
          },
          {
            "name": "openshift_etcd_node_on_vmware",
            "label": "OpenShift Container Platform ETCD Node on VMware Data Object",
            "customtype": "sharedparameter",
            "type": "sharedparameter",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "OpenShift Container Platform ETCD Node on VMware Data Object",
            "default": "",
            "datatype": "openshift_etcd_node_on_vmware"
          },
          {
            "name": "openshift_compute_node_on_vmware",
            "label": "OpenShift Container Platform Compute Node on VMware Data Object",
            "customtype": "sharedparameter",
            "type": "sharedparameter",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "OpenShift Container Platform Compute Node on VMware Data Object",
            "default": "",
            "datatype": "openshift_compute_node_on_vmware"
          },
          {
              "name": "bastion_host",
              "label": "Bastion Host Configuration",
              "customtype": "sharedparameter",
              "type": "sharedparameter",
              "immutable": false,
              "hidden": false,
              "required": true,
              "secured": false,
              "description": "Bastion Host configuration",
              "default": "DefaultNoBastionHostRequired",
              "datatype": "bastionhost"
          },
          {
              "name": "mcm_controller",
              "label": "IBM MCM Controller Definition",
              "customtype": "sharedparameter",
              "type": "sharedparameter",
              "immutable": false,
              "hidden": false,
              "required": true,
              "secured": false,
              "description": "IBM MCM Controller (hub cluster) details will be used to import a managed cluster to the controller.",
              "default": "",
              "datatype": "mcm_controller"
          },
          {
            "name": "master_node_hostname_ip",
            "label": "Master Node Hostname and IP",
            "customtype": "map",
            "type": "map",
            "immutable": false,
            "hidden": false,
            "required": false,
            "secured": false,
            "description": "Master Node Hostname and IP",
            "default": {
              "": ""
            }
          },
          {
            "name": "etcd_node_hostname_ip",
            "label": "ETCD Node Hostname and IP",
            "customtype": "map",
            "type": "map",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "ETCD Node Hostname and IP",
            "default": {
              "": ""
            }
          },
          {
            "name": "infra_node_hostname_ip",
            "label": "Infrastructure Node Hostname and IP",
            "customtype": "map",
            "type": "map",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Infrastructure Node Hostname and IP",
            "default": {
              "": ""
            }
          },
          {
            "name": "lb_node_hostname_ip",
            "label": "LB Node Hostname and IP",
            "customtype": "map",
            "type": "map",
            "immutable": false,
            "hidden": false,
            "required": false,
            "secured": false,
            "description": "LB Node Hostname and IP",
            "default": {
              "Hostname": "0.0.0.0"
            }
          },
          {
            "name": "compute_node_hostname_ip",
            "label": "Compute Node Hostname and IP (at least 3)",
            "customtype": "map",
            "type": "map",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "Compute Node Hostname and IP (at least 3)",
            "default": {
              "Hostname1": "0.0.0.0",
              "Hostname2": "0.0.0.0",
              "Hostname3": "0.0.0.0"
            }
          },
          {
            "name": "enable_lb",
            "label": "Enable Load Balancer",
            "customtype": "string",
            "type": "string",
            "immutable": false,
            "hidden": false,
            "required": true,
            "secured": false,
            "description": "",
            "options": [
              {
                "label": "True",
                "value": "true",
                "default": false
              },
              {
                "label": "False",
                "value": "false",
                "default": true
              }
            ]
          },
          {
              "name": "vm_os_user",
              "label": "OS root user",
              "customtype": "string",
              "type": "string",
              "immutable": false,
              "hidden": false,
              "required": true,
              "secured": false,
              "description": "OS root user for ICP nodes",
              "default": "root"
          },
          {
              "name": "vm_os_password",
              "label": "OS root password",
              "customtype": "password",
              "type": "password",
              "immutable": false,
              "hidden": false,
              "required": true,
              "secured": true,
              "description": "OS root password for ICP nodes",
              "default": "^(cGFzc3cwcmQ=)"
          },
          {
              "name": "download_user",
              "description": "Username to access a secure repository location",
              "customtype": "string",
              "type": "string",
              "required": false,
              "secured": false,
              "label": "Binary Repository User Name (Optional)",
              "hidden": false,
              "immutable": false
          },
          {
              "name": "download_user_password",
              "description": "Password for the Username to access a secure repository location",
              "customtype": "string",
              "type": "password",
              "required": false,
              "secured": true,
              "label": "Binary Repository User Password (Optional)",
              "hidden": false,
              "immutable": false
          },
          {
              "name": "icp_binary_url",
              "description": "Location of the IBM Cloud Private Binaries used by IBM Cloud Private",
              "customtype": "string",
              "type": "string",
              "required": true,
              "secured": false,
              "label": "IBM Cloud Private Download Location (http|https|ftp|file)",
              "hidden": false,
              "immutable": false,
              "regex": "(https?|ftp|file)://[-A-Za-z0-9\\+&@#/%?=~_|!:,.;]*[-A-Za-z0-9\\+&@#/%=~_|]",
              "regexdesc": "http|https|ftp|file Location to download the IBM Cloud Private Binaries"
            },
            {
              "name": "icp_cluster_name",
              "description": "IBM Cloud Private Cluster Name",
              "customtype": "string",
              "type": "string",
              "required": true,
              "secured": false,
              "label": "IBM Cloud Private Cluster Name",
              "hidden": false,
              "immutable": false,
              "regex": "^[a-z0-9.-]{1,80}$"
            },
            {
              "name": "icp_admin_user",
              "description": "IBM Cloud Private Admin User Name",
              "customtype": "string",
              "default": "admin",
              "type": "string",
              "required": true,
              "secured": false,
              "label": "IBM Cloud Private Admin Username",
              "hidden": false,
              "immutable": false
            },
            {
              "name": "icp_admin_password",
              "description": "IBM Cloud Private Admin User Password",
              "customtype": "string",
              "type": "password",
              "required": true,
              "secured": true,
              "label": "IBM Cloud Private Admin Password",
              "hidden": false,
              "immutable": false,
              "regex": "^([a-zA-Z0-9\\-]{32,})$",
              "regexdesc": "Allow alphanumeric characters or - symbol. Must have at least 32 characters"
            },
            {
              "name": "icp_private_ssh_key",
              "description": "IBM Cloud Private - Private SSH key for access between boxes (base64 encoded)",
              "customtype": "string",
              "default": "",
              "type": "string",
              "required": false,
              "secured": true,
              "label": "IBM Cloud Private - Private SSH Key",
              "hidden": false,
              "immutable": false
            },
            {
              "name": "icp_public_ssh_key",
              "description": "IBM Cloud Private - Public SSH key for access between boxes",
              "customtype": "string",
              "default": "",
              "type": "string",
              "required": false,
              "secured": false,
              "label": "IBM Cloud Private - Public SSH Key",
              "hidden": false,
              "immutable": false
            }
          ],
          "flow": {
            "conditions": [],
            "templates": [
              {
                "OpenShift Container Platform Enterprise Installation": {
                  "title": "OpenShift Container Platform Enterprise Installation_bd443f",
                  "template_name": "OpenShift Container Platform Enterprise Installation",
                  "version": "3.11",
                  "id": "openshifaf6167b2",
                  "template_type": "Terraform",
                  "template_content_type": "VMware vSphere",
                  "template_provider": "VMware vSphere",
                  "instance_name": "",
                  "cloud_connection_name": "${input_parameters.cloud_connection}",
                  "template_data_objects": {
                    "bastionhost": "DefaultNoBastionHostRequired",
                    "openshift_master_node_on_vmware": "${input_parameters.openshift_master_node_on_vmware}",
                    "openshift_infra_node_on_vmware": "${input_parameters.openshift_infra_node_on_vmware}",
                    "openshift_etcd_node_on_vmware": "${input_parameters.openshift_etcd_node_on_vmware}",
                    "openshift_compute_node_on_vmware": "${input_parameters.openshift_compute_node_on_vmware}",
                    "openshift_lb_node_on_vmware": "${input_parameters.openshift_lb_node_on_vmware}",
                    "vsphere_managed_inventory_definition": "${input_parameters.vsphere_managed_inventory_definition}",
                    "redhat_subscription": "${input_parameters.redhat_subscription}"
                  },
                  "template_params": {
                    "datacenter": "${vsphere_managed_inventory_definition.datacenter}",
                    "resource_pool": "${vsphere_managed_inventory_definition.resource_pool}",
                    "vm_folder": "${vsphere_managed_inventory_definition.vm_folder}",
                    "vm_image_template": "${vsphere_managed_inventory_definition.vm_image_template}",
                    "vm_domain_name": "${vsphere_managed_inventory_definition.vm_domain_name}",
                    "vm_os_user": "${vsphere_managed_inventory_definition.vm_os_user}",
                    "vm_os_password": "${vsphere_managed_inventory_definition.vm_os_password}",
                    "vm_os_private_ssh_key": "${vsphere_managed_inventory_definition.vm_os_private_ssh_key}",
                    "vm_os_public_ssh_key": "${vsphere_managed_inventory_definition.vm_os_public_ssh_key}",
                    "datastore": "${vsphere_managed_inventory_definition.datastore}",
                    "network": "${vsphere_managed_inventory_definition.network}",
                    "dns_servers": "${vsphere_managed_inventory_definition.dns_servers}",
                    "dns_suffixes": "${vsphere_managed_inventory_definition.dns_suffixes}",
                    "vm_ipv4_gateway": "${vsphere_managed_inventory_definition.vm_ipv4_gateway}",
                    "vm_ipv4_netmask": "${vsphere_managed_inventory_definition.vm_ipv4_netmask}",
                    "compute_node_enable_glusterfs": "true",
                    "compute_node_hostname_ip": "${input_parameters.compute_node_hostname_ip}",
                    "compute_node_memory": "${openshift_compute_node_on_vmware.memory}",
                    "compute_node_vcpu": "${openshift_compute_node_on_vmware.vcpu}",
                    "compute_node_disk1_size": "${openshift_compute_node_on_vmware.disk1_size}",
                    "compute_node_disk2_size": "${openshift_compute_node_on_vmware.disk2_size}",
                    "etcd_node_hostname_ip": "${input_parameters.etcd_node_hostname_ip}",
                    "etcd_node_memory": "${openshift_etcd_node_on_vmware.memory}",
                    "etcd_node_vcpu": "${openshift_etcd_node_on_vmware.vcpu}",
                    "etcd_node_disk1_size": "${openshift_etcd_node_on_vmware.disk1_size}",
                    "infra_node_hostname_ip": "${input_parameters.infra_node_hostname_ip}",
                    "infra_node_memory": "${openshift_infra_node_on_vmware.memory}",
                    "infra_node_vcpu": "${openshift_infra_node_on_vmware.vcpu}",
                    "infra_node_disk1_size": "${openshift_infra_node_on_vmware.disk1_size}",
                    "enable_lb": "${input_parameters.enable_lb}",
                    "lb_node_hostname_ip": "${input_parameters.lb_node_hostname_ip}",
                    "lb_node_memory": "${openshift_lb_node_on_vmware.memory}",
                    "lb_node_vcpu": "${openshift_lb_node_on_vmware.vcpu}",
                    "lb_node_disk1_size": "${openshift_lb_node_on_vmware.disk1_size}",
                    "master_node_hostname_ip": "${input_parameters.master_node_hostname_ip}",
                    "master_node_memory": "${openshift_master_node_on_vmware.memory}",
                    "master_node_vcpu": "${openshift_master_node_on_vmware.vcpu}",
                    "master_node_disk1_size": "${openshift_master_node_on_vmware.disk1_size}",
                    "openshift_user": "${input_parameters.openshift_admin_username}",
                    "openshift_password": "${input_parameters.openshift_admin_password}",
                    "rh_user": "${redhat_subscription.username}",
                    "rh_password": "${redhat_subscription.password}"
                  },
                  "outputs": [
                    "cluster_name",
                    "openshift_url",
                    "openshift_user",
                    "openshift_password",
                    "openshift_master_ip",
                    "openshift_infra_ip",
                    "openshift_compute1_hostname",
                    "openshift_compute2_hostname",
                    "openshift_compute3_hostname",
                    "openshift_console_fqdn",
                    "openshift_console_port"
                  ],
                  "error": false
                }
              },
              {
                "IBM Cloud Private on OpenShift Container Platform": {
                  "title": "IBM Cloud Private on OpenShift Container Platform_796449",
                  "template_name": "IBM Cloud Private on OpenShift Container Platform",
                  "version": "3.2.1",
                  "id": "ibmcloud8ba870a7",
                  "template_type": "Terraform",
                  "template_content_type": "VMware vSphere",
                  "template_provider": "VMware vSphere",
                  "instance_name": "",
                  "cloud_connection_name": "${input_parameters.cloud_connection}",
                  "template_data_objects": {
                    "bastionhost": "DefaultNoBastionHostRequired",
                    "vsphere_managed_inventory_definition": "${input_parameters.vsphere_managed_inventory_definition}"
                  },
                  "template_params": {
                    "download_user": "${input_parameters.download_user}",
                    "download_user_password": "${input_parameters.download_user_password}",
                    "icp_binary_url": "${input_parameters.icp_binary_url}",
                    "icp_cluster_name": "${input_parameters.icp_cluster_name}",
                    "icp_admin_user": "${input_parameters.icp_admin_user}",
                    "icp_admin_password": "${input_parameters.icp_admin_password}",
                    "icp_management_host": "${templates.openshifaf6167b2.output.openshift_compute1_hostname}",
                    "icp_master_host": "${templates.openshifaf6167b2.output.openshift_compute2_hostname}",
                    "icp_proxy_host": "${templates.openshifaf6167b2.output.openshift_compute3_hostname}",
                    "icp_private_ssh_key": "${input_parameters.icp_private_ssh_key}",
                    "icp_public_ssh_key": "${input_parameters.icp_public_ssh_key}",
                    "ocp_master_ip": "${templates.openshifaf6167b2.output.openshift_master_ip}",
                    "ocp_infra_ip": "${templates.openshifaf6167b2.output.openshift_infra_ip}",
                    "ocp_vm_domain_name": "${vsphere_managed_inventory_definition.vm_domain_name}",
                    "installer_vm_os_user": "${vsphere_managed_inventory_definition.vm_os_user}",
                    "installer_vm_os_password": "${vsphere_managed_inventory_definition.vm_os_password}",
                    "ocp_enable_glusterfs": "true",
                    "ocp_console_fqdn": "${templates.openshifaf6167b2.output.openshift_console_fqdn}",
                    "ocp_console_port": "${templates.openshifaf6167b2.output.openshift_console_port}"
                  },
                  "outputs": [
                    "ibm_cloud_private_admin_user",
                    "ibm_cloud_private_admin_password",
                    "ibm_cloud_private_admin_url",
                    "ocp_infra_ip",
                    "ibm_cloud_private_boot_ip",
                    "docker_reg_token"
                  ],
                  "error": false
                }
              },
              {
                "IBM Multicloud Manager Klusterlet on IBM Cloud Private": {
                  "title": "IBM Multicloud Manager Klusterlet on IBM Cloud Private_bcb457",
                  "template_name": "IBM Multicloud Manager Klusterlet on IBM Cloud Private",
                  "version": "3.2.1",
                  "id": "ibmmulti4121b13e",
                  "template_type": "Terraform",
                  "template_content_type": "Other",
                  "template_provider": "Other",
                  "instance_name": "",
                  "cloud_connection_name": "Other",
                  "template_data_objects": {
                    "bastionhost": "DefaultNoBastionHostRequired",
                    "mcm_controller": "${input_parameters.mcm_controller}"
                  },
                  "template_params": {
                    "mcm_url": "${mcm_controller.icp_url}",
                    "mcm_admin_user": "${mcm_controller.icp_admin_user}",
                    "mcm_admin_password": "${mcm_controller.icp_admin_password}",
                    "cluster_name": "managed-${input_parameters.icp_cluster_name}",
                    "cluster_namespace": "managed-${input_parameters.icp_cluster_name}-ns",
                    "icp_url": "${templates.ibmcloud8ba870a7.output.ibm_cloud_private_admin_url}",
                    "icp_admin_user": "${input_parameters.icp_admin_user}",
                    "icp_admin_password": "${input_parameters.icp_admin_password}",
                    "image_registry": "docker-registry-default.${templates.ibmcloud8ba870a7.output.ocp_infra_ip}.nip.io/ibmcom",
                    "image_suffix": "",
                    "image_version": "3.2.1-rhel",
                    "docker_user": "${input_parameters.openshift_admin_username}",
                    "docker_password": "${templates.ibmcloud8ba870a7.output.docker_reg_token}"
                  },
                  "error": false
                }
              }
            ],
            "resthooks": [],
            "notifications": [],
            "sequence": {
              "0": "openshifaf6167b2",
              "1": "ibmcloud8ba870a7",
              "2": "ibmmulti4121b13e"
            },
            "error_sequence": {}
          },
          "output_parameters": []
        }
      ],
      "plans": [
        {
          "name": "Standard",
          "description": "To deploy a Standard plan",
          "actions": [],
          "plan_parameters": []
        }
      ]
    }
  }